<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Unusual Pills</title>

  <meta name="description" content="Unusual Pills — art, merch, music, and interactive oddities." />
  <meta name="theme-color" content="#0c0c0e" />
  <meta property="og:title" content="Unusual Pills" />
  <meta property="og:description" content="Art. Merch. Music. Claw the weird." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="static/images/unusualpills-og.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <link rel="preload" as="image" href="static/images/background.png" imagesrcset="static/images/background.png" />

  <!-- === SPLASH ADD: minimal styles for intro + fade-in === -->
  <style>
    .splash {
      position: fixed; inset: 0; display: grid; place-items: center;
      background: #000; z-index: 9999;
    }
    .splash .kaomoji {
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      text-align: center;
      color: #fff; user-select: none;
      text-shadow: 0 0 10px #ff2a6d, 0 0 18px #7cffc1;
    }
    .splash .kaomoji .fr {
      font-size: clamp(18px,3.5vw,28px);
      opacity:.95; margin-bottom:.25em; letter-spacing:.5px;
      transform: translateY(6px); opacity: 0;
      animation: frIn 0.7s ease forwards .2s;
    }
    .splash .kaomoji .face {
      font-size: clamp(28px,8vw,80px);
      transform: scale(.9); opacity: 0;
      animation: faceIn 0.8s ease forwards .45s;
    }
    @keyframes frIn { to { transform: translateY(0); opacity: 1; } }
    @keyframes faceIn { to { transform: scale(1); opacity: 1; } }

    .flash { position: fixed; inset: 0; opacity: 0;
      background: radial-gradient(circle, #fff, transparent 60%); }
    .boom { animation: flash .5s ease-out forwards; }
    @keyframes flash { 0%{opacity:0} 20%{opacity:1} 100%{opacity:0} }

    .particle {
      position: fixed; width: 6px; height: 6px; border-radius: 50%;
      background: linear-gradient(180deg,#ff7a1a,#5eb9ff); /* pill-orange → xanax-blue */
      box-shadow: 0 0 6px rgba(255,255,255,.8);
      pointer-events: none; animation: fly .9s ease-out forwards;
      mix-blend-mode: screen;
    }
    @keyframes fly { to { transform: translate(var(--x), var(--y)) scale(.6); opacity:0 } }

    /* Hide real UI until splash completes */
    main, .topbar { opacity: 0; transition: opacity .6s ease; }
    body.ready main, body.ready .topbar { opacity: 1; }
  </style>
  <!-- === /SPLASH ADD === -->

  <style>
    :root{
      --max-img: 300px;
      --ring: 255 255 255 / 85%;
      --fade-ms: 380ms;
      --merch-drop: clamp(180px, 22vh, 360px);
    }

    body{
      margin:0;
      background:#0c0c0e url("static/images/background.png") no-repeat center center fixed;
      background-size:cover;
      color:#fff;
      font-family:Arial, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, sans-serif;
      min-height:100dvh;
      display:grid;
      place-items:center;
      position:relative;
      overflow:hidden;
      opacity:0;
      animation:fadeIn var(--fade-ms) ease forwards;
    }
    @keyframes fadeIn{to{opacity:1}}

    /* simple top bar to show Cart (N) */
    .topbar{
      position:fixed; inset:0 0 auto 0;
      display:flex; justify-content:flex-end; align-items:center;
      padding:10px 14px; gap:12px;
      background:linear-gradient(180deg, rgba(0,0,0,.45), rgba(0,0,0,0));
      z-index:10;
      pointer-events:none;
    }
    .topbar a{ pointer-events:auto; color:#d7e8ff; text-decoration:none; font-weight:600 }
    .pill-badge{
      background:#fff; color:#000; border-radius:999px; padding:6px 10px; font-weight:700
    }

    main{display:contents}

    .logo,.merch-pill,.snail{
      width:min(60vw,var(--max-img));
      max-width:var(--max-img);
      cursor:pointer;
      transition:transform .3s ease;
      margin-top:20px;
      display:block;
    }

    .logo{
      transform: none;
      transform-origin:center center;
      filter: drop-shadow(0 0 6px rgba(255,255,255,.35));
      animation: logoGlow 3.6s infinite steps(1,end);
    }
    .logo:hover{ transform: scale(1.05); }
    @keyframes logoGlow{
      0%,8%{ filter: drop-shadow(0 0 6px rgba(255,255,255,.35)) brightness(1); }
      9%{ filter: drop-shadow(0 0 14px rgba(255,255,255,.6)) brightness(1.15); }
      10%,12%{ filter: drop-shadow(0 0 3px rgba(255,255,255,.2)) brightness(.9); }
      30%{ filter: drop-shadow(0 0 10px rgba(255,255,255,.45)) brightness(1.05); }
      50%{ filter: drop-shadow(0 0 7px rgba(255,255,255,.35))  brightness(1); }
      70%{ filter: drop-shadow(0 0 12px rgba(255,255,255,.5))  brightness(1.1); }
      100%{ filter: drop-shadow(0 0 6px rgba(255,255,255,.35))  brightness(1); }
    }
    .logo.glitch{
      transform: translateX(2px) skewX(.4deg);
      filter:
        drop-shadow(-2px 0 rgba(255,0,180,.55))
        drop-shadow( 2px 0 rgba(0,255,255,.55))
        drop-shadow( 0  0 8px rgba(255,255,255,.45))
        saturate(1.25) contrast(1.1);
      animation: glitchPulse 180ms steps(1,end) 1;
    }
    @keyframes glitchPulse{
      0%{clip-path:inset(0 0 0 0)}
      50%{clip-path:inset(1% 0 0 0)}
      100%{clip-path:inset(0 0 1% 0)}
    }

    .merch-pill{ margin-top: var(--merch-drop); position: relative; z-index: 2; }
    .merch-pill:hover, .snail:hover{ transform: scale(1.05) }

    .merch-wrap{ position: relative; display: inline-block; }
    .cap{
      position:absolute; left:50%;
      top: calc(var(--cap-top, -6%) );
      width: 40%; height: 14%;
      transform: translateX(-50%) rotate(-20deg);
      border-radius: 12px;
      background: linear-gradient(#e6e6e6,#bfbfbf);
      box-shadow: 0 2px 6px rgba(0,0,0,.35);
      opacity: 0; pointer-events: none; z-index:3;
      filter: drop-shadow(0 0 6px rgba(255,255,255,.25));
    }
    .merch-opening .cap{ animation: capPop 500ms ease forwards; }
    @keyframes capPop{
      0%{ opacity:0; transform: translateX(-50%) translateY(0) rotate(-20deg) }
      40%{ opacity:1; transform: translateX(-50%) translateY(-30%) rotate(-42deg) }
      100%{ opacity:1; transform: translateX(-50%) translateY(-50%) rotate(-60deg) }
    }

    .pill-fx{
      position:absolute; bottom:56%; left:50%;
      width:6px; height:6px; border-radius:50%;
      background: currentColor; opacity:0; pointer-events:none; z-index:4;
      box-shadow:0 0 8px currentColor; animation: pillRise 900ms ease-out forwards;
    }
    @keyframes pillRise{
      0%{ transform: translate(-50%,0) scale(.9); opacity:0 }
      20%{ opacity:1 }
      100%{ transform: translate(-50%,-120px) scale(1); opacity:0 }
    }

    .snail-link{ position:absolute; left:16px; top:50%; transform:translateY(-50%); z-index:1; text-decoration:none; outline:none; }
    #glitchFace{ width:min(60vw,var(--max-img)); max-width:var(--max-img); height:auto; display:block; border-radius:16px; box-shadow:0 10px 40px rgba(0,0,0,.35); }

    .center-links{ display:flex; flex-direction:column; align-items:center; z-index:2; }

    .snail-link:focus-visible #glitchFace,
    a:focus-visible img{ outline:3px solid rgba(var(--ring)); outline-offset:6px; border-radius:16px; }

    .skip{ position:absolute; left:12px; top:-40px; padding:8px 12px; background:rgba(0,0,0,.6); color:#fff; border-radius:12px; transition:top .2s ease; text-decoration:none; z-index:4; }
    .skip:focus{ top:12px }

    @media (orientation: portrait){
      :root{ --merch-drop: clamp(170px, 20vh, 340px) }
      .snail-link{ top:48% }
    }
    @media (min-height: 1100px) and (orientation: portrait){
      :root{ --merch-drop: clamp(150px, 18vh, 320px) }
    }
    @media (max-width: 640px){
      body{ overflow:auto; padding:20px 0; background-attachment:scroll }
      .snail-link{ position:static; transform:none; margin-top:10px; order:-1 }
      .logo,.merch-pill,.snail,#glitchFace{ width:min(80vw,var(--max-img)) }
      :root{ --merch-drop: clamp(120px, 18vh, 240px) }
      .center-links{ margin-top:10px }
    }
    @media (prefers-reduced-motion: reduce){
      body{ animation:none; opacity:1 }
      .logo{ animation:none }
      .logo.glitch{ animation:none }
      .logo:hover,.merch-pill:hover,.snail:hover{ transform:none }
    }

    /* === ADDED: social links (glowing pill buttons) === */
    .social-links {
      display:flex;
      gap:18px;
      margin-top:28px;
      flex-wrap:wrap;
      justify-content:center;
    }
    .social-links a {
      position:relative;
      text-decoration:none;
      color:#fff;
      font-weight:600;
      padding:10px 20px;
      border-radius:999px;
      background:linear-gradient(90deg,#ff7a1a,#5eb9ff);
      box-shadow:0 0 12px rgba(255,255,255,0.25);
      transition:transform .25s ease,box-shadow .25s ease;
    }
    .social-links a:hover {
      transform:scale(1.07);
      box-shadow:0 0 16px rgba(255,255,255,0.45);
    }
    .social-links a::before {
      content:'';
      position:absolute;
      inset:0;
      border-radius:999px;
      background:linear-gradient(90deg,#ff7a1a,#5eb9ff);
      filter:blur(8px);
      opacity:.7;
      z-index:-1;
      transition:opacity .3s ease;
    }
    .social-links a:hover::before{opacity:1;}
  </style>
</head>
<body>
  <!-- === SPLASH ADD: above everything, removed after 1.6s === -->
  <div class="splash" id="splash" aria-hidden="true">
    <div class="kaomoji">
      <div class="fr">Bienvenue, <strong>Wizler</strong></div>
      <div class="face">(◉‿◉)</div>
    </div>
    <div class="flash" id="flash"></div>
  </div>
  <!-- === /SPLASH ADD === -->

  <a class="skip" href="#nav-target">Skip to main links</a>

  <!-- simple top bar with Cart (N) -->
  <div class="topbar">
    <a href="cart.html" aria-label="Open cart">Cart (<span id="cartCount">0</span>)</a>
  </div>

  <main role="main" aria-label="Unusual Pills landing">
    <!-- Left “trippy eye” canvas linking to art -->
    <a class="snail-link" href="art.html" aria-label="Open the Art page" title="Open Art">
      <canvas id="glitchFace" class="snail">Art</canvas>
    </a>

    <!-- Center links / buttons -->
    <div class="center-links" id="nav-target" role="navigation" aria-label="Primary">
      <a href="claw.html" aria-label="Start Claw Machine">
        <img src="static/images/unusualpills.png" alt="Start the claw machine" class="logo" loading="eager" />
      </a>

      <a href="merch.html" aria-label="Go to Merch" class="merch-wrap" id="merchWrap">
        <div class="cap" aria-hidden="true"></div>
        <img src="static/images/merch.png" alt="Open the merch page" class="merch-pill" loading="lazy" />
      </a>

      <!-- === ADDED: Social links === -->
      <div class="social-links">
        <a href="https://www.instagram.com/wizl_er" target="_blank" rel="noopener" aria-label="Instagram">Instagram</a>
        <a href="https://www.tiktok.com/@wizl_er" target="_blank" rel="noopener" aria-label="TikTok">TikTok</a>
        <a href="https://www.youtube.com/@wizlerr" target="_blank" rel="noopener" aria-label="YouTube">YouTube</a>
      </div>
    </div>
  </main>

  <!-- === SPLASH ADD: tiny script to run the boom + remove splash === -->
  <script>
    (function(){
      function boom(x = innerWidth/2, y = innerHeight/2){
        const f = document.getElementById('flash');
        if (f){ f.classList.add('boom'); setTimeout(()=>f.classList.remove('boom'), 520); }
        for(let i=0;i<70;i++){
          const p=document.createElement('div');
          p.className='particle';
          const ang=Math.random()*Math.PI*2;
          const mag=110+Math.random()*240;
          p.style.left=x+'px'; p.style.top=y+'px';
          p.style.setProperty('--x', Math.cos(ang)*mag+'px');
          p.style.setProperty('--y', Math.sin(ang)*mag+'px');
          document.body.appendChild(p);
          setTimeout(()=>p.remove(), 950);
        }
      }
      window.addEventListener('load', ()=>{
        boom();
        setTimeout(()=>{
          document.body.classList.add('ready');
          const s=document.getElementById('splash');
          if(s) s.remove();
        }, 1600);
      });
    })();
  </script>
  <!-- === /SPLASH ADD === -->

  <!-- Trippy Eye script (replaces old face) -->
  <script>
  (() => {
    const canvas = document.getElementById('glitchFace');
    const ctx = canvas.getContext('2d', { alpha: true });
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    function setCanvasSize() {
      const dpr = Math.max(1, devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      const w = Math.max(220, Math.floor(rect.width * dpr));
      const h = Math.max(220, Math.floor((rect.width * 0.75) * dpr));
      canvas.width = w;
      canvas.height = h;
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }

    function drawEye(t = 0) {
      const w = canvas.clientWidth || canvas.width;
      const h = canvas.clientHeight || canvas.height;
      const cx = w / 2, cy = h / 2;
      const eyeW = Math.min(w * 0.86, h * 1.15);
      const eyeH = eyeW * 0.56;

      ctx.clearRect(0, 0, w, h);

      // Sclera with soft glow
      const scleraGrad = ctx.createRadialGradient(cx, cy, eyeW*0.06, cx, cy, eyeW*0.52);
      scleraGrad.addColorStop(0, 'rgba(250,250,255,0.95)');
      scleraGrad.addColorStop(1, 'rgba(210,220,255,0.75)');
      ctx.fillStyle = scleraGrad;
      roundedOval(cx, cy, eyeW, eyeH, 0);
      ctx.shadowColor = 'rgba(255,255,255,0.35)';
      ctx.shadowBlur = 18;
      ctx.fill();
      ctx.shadowBlur = 0;

      // Chromatic fringe pass
      ctx.globalCompositeOperation = 'screen';
      ctx.filter = 'blur(0.4px)';
      ctx.save(); ctx.translate(1.5, 0); ctx.globalAlpha = 0.35; ctx.drawImage(canvas, 0, 0); ctx.restore();
      ctx.save(); ctx.translate(-1.5, 0); ctx.globalAlpha = 0.35; ctx.drawImage(canvas, 0, 0); ctx.restore();
      ctx.filter = 'none'; ctx.globalCompositeOperation = 'source-over';

      // Iris: rotating psychedelic radial field
      const irisR = eyeH * 0.34;
      const hue = (t * 0.03) % 360;
      for (let i = 0; i < 140; i++) {
        const a0 = (i / 140) * Math.PI * 2;
        const a1 = ((i + 1) / 140) * Math.PI * 2;
        const inner = irisR * 0.25 + Math.sin(a0 * 7 + t * 0.02) * 3;
        const outer = irisR * (0.95 + Math.sin(a0 * 5 + t * 0.015) * 0.03);
        ctx.beginPath();
        ctx.moveTo(cx + Math.cos(a0) * inner, cy + Math.sin(a0) * inner);
        ctx.lineTo(cx + Math.cos(a0) * outer, cy + Math.sin(a0) * outer);
        ctx.lineTo(cx + Math.cos(a1) * outer, cy + Math.sin(a1) * outer);
        ctx.lineTo(cx + Math.cos(a1) * inner, cy + Math.sin(a1) * inner);
        const sat = 80 + 20 * Math.sin(a0 * 9 + t * 0.01);
        const light = 45 + 10 * Math.cos(a0 * 6 - t * 0.012);
        ctx.fillStyle = `hsl(${(hue + i*2)%360} ${sat}% ${light}%)`;
        ctx.fill();
      }
      // Iris ring
      ctx.lineWidth = 2;
      ctx.strokeStyle = 'rgba(255,255,255,0.75)';
      ctx.beginPath(); ctx.arc(cx, cy, irisR * 0.98, 0, Math.PI * 2); ctx.stroke();

      // Pupil (dilating)
      const pupilR = irisR * (0.26 + 0.08 * Math.sin(t * 0.02));
      ctx.beginPath(); ctx.fillStyle = '#0a0a12';
      ctx.arc(cx, cy, pupilR, 0, Math.PI * 2); ctx.fill();

      // Glints
      ctx.fillStyle = 'rgba(255,255,255,0.9)';
      ctx.beginPath(); ctx.arc(cx - pupilR*0.5, cy - pupilR*0.6, pupilR*0.18, 0, Math.PI*2); ctx.fill();
      ctx.beginPath(); ctx.globalAlpha = 0.5; ctx.arc(cx + pupilR*0.35, cy - pupilR*0.75, pupilR*0.08, 0, Math.PI*2); ctx.fill(); ctx.globalAlpha = 1;

      // Scanline/glitch streaks
      if (Math.random() < 0.5) {
        const lines = 4;
        for (let i = 0; i < lines; i++) {
          const y = cy + (Math.random() - 0.5) * eyeH * 0.8;
          ctx.globalAlpha = 0.06 + Math.random() * 0.08;
          ctx.fillStyle = '#fff';
          ctx.fillRect(cx - eyeW*0.45, y, eyeW*0.9, 1);
        }
        ctx.globalAlpha = 1;
      }

      // Outer stroke
      ctx.lineWidth = 3; ctx.strokeStyle = 'rgba(255,255,255,0.9)';
      roundedOval(cx, cy, eyeW, eyeH, 0); ctx.stroke();
    }

    function roundedOval(cx, cy, w, h, rot=0) {
      const rx = w/2, ry = h/2;
      const k = 0.552284749831;
      const cpx = rx * k, cpy = ry * k;

      ctx.save();
      ctx.translate(cx, cy); ctx.rotate(rot);
      ctx.beginPath();
      ctx.moveTo(rx, 0);
      ctx.bezierCurveTo(rx, -cpy, cpx, -ry, 0, -ry);
      ctx.bezierCurveTo(-cpx, -ry, -rx, -cpy, -rx, 0);
      ctx.bezierCurveTo(-rx, cpy, -cpx, ry, 0, ry);
      ctx.bezierCurveTo(cpx, ry, rx, cpy, rx, 0);
      ctx.closePath();
      ctx.restore();
    }

    let rafId = null;
    function animate(t) {
      drawEye(t);
      if (!prefersReduced) rafId = requestAnimationFrame(animate);
    }

    function start() {
      setCanvasSize();
      drawEye(0);
      if (!prefersReduced) {
        cancelAnimationFrame(rafId);
        rafId = requestAnimationFrame(animate);
      }
    }

    const ro = new ResizeObserver(start);
    ro.observe(canvas);
    window.addEventListener('orientationchange', () => setTimeout(start, 250));

    start();

    // Keyboard access (Enter/Space)
    const link = canvas.parentElement;
    link.setAttribute('tabindex', '0');
    link.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        link.click();
      }
    });
  })();
  </script>

  <!-- Global cart utilities + topbar count -->
  <script>
    // Basic cart helpers shared across pages
    window.Cart = {
      get(){ return JSON.parse(localStorage.getItem('cart')||'[]'); },
      set(c){ localStorage.setItem('cart', JSON.stringify(c)); window.Cart.updateCount(); },
      clear(){ localStorage.removeItem('cart'); window.Cart.updateCount(); },
      add(product){
        // Expecting: {id,name,price_cents,currency,is_shirt,quantity?}
        const p = {...product};
        if (typeof p.quantity === 'undefined') p.quantity = 1;
        if (typeof p.currency === 'undefined') p.currency = 'usd';
        if (typeof p.is_shirt === 'undefined') p.is_shirt = false;

        const cart = window.Cart.get();
        const existing = cart.find(i => i.id === p.id);
        if (existing) existing.quantity += p.quantity;
        else cart.push(p);
        window.Cart.set(cart);
      },
      updateCount(){
        const n = window.Cart.get().reduce((s,i)=>s + (i.quantity||0), 0);
        const el = document.getElementById('cartCount');
        if (el) el.textContent = n;
      }
    };
    window.addEventListener('storage', window.Cart.updateCount);
    window.Cart.updateCount();
  </script>

  <!-- Logo tiny random glitch + Merch “open bottle” interaction -->
  <script>
    (() => {
      const logo = document.querySelector('.logo');
      if (!logo) return;
      const reduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (reduced) return;
      function maybeGlitch(){
        if (Math.random() < 0.28){
          logo.classList.add('glitch');
          setTimeout(()=>logo.classList.remove('glitch'), 180);
        }
      }
      setInterval(maybeGlitch, 1200);
    })();

    (() => {
      const wrap = document.getElementById('merchWrap');
      if (!wrap) return;
      const reduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      wrap.addEventListener('click', (e) => {
        if (reduced) return; // just navigate
        e.preventDefault();

        wrap.classList.add('merch-opening');

        for (let i = 0; i < 8; i++){
          const dot = document.createElement('span');
          dot.className = 'pill-fx';
          const colors = ['#ff73d3','#7df0ff','#ffd36e','#98ff95','#d6a3ff'];
          dot.style.color = colors[(Math.random()*colors.length)|0];
          const drift = (Math.random()*80 - 40);
          const delay = Math.random()*120;
          dot.style.left = `calc(50% + ${drift}px)`;
          dot.style.animationDelay = `${delay}ms`;
          wrap.appendChild(dot);
          setTimeout(()=>dot.remove(), 1200 + delay);
        }

        const img = wrap.querySelector('.merch-pill');
        img.animate([
          { transform: 'translateY(0) scale(1)' },
          { transform: 'translateY(-6px) scale(1.02)' },
          { transform: 'translateY(0) scale(1)' }
        ], { duration: 380, easing: 'ease-out' });

        setTimeout(()=>{ window.location.href = wrap.href; }, 280);
        setTimeout(()=>wrap.classList.remove('merch-opening'), 800);
      }, { passive:false });
    })();
  </script>

  <noscript>
    <style>
      .js-warning{ position:fixed; inset:auto 0 0 0; padding:10px 14px; background:rgba(0,0,0,.7); color:#fff; text-align:center; font-size:14px; }
    </style>
    <div class="js-warning">JavaScript is required for animations. Links still work ↑</div>
  </noscript>
</body>
</html>
